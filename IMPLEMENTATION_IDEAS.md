# プロダクト以外の追加実装可能な機能

ブルームコネクトの基本機能（スタッフ管理、利用者管理、事業所管理）とプラン・料金体系に加えて、以下の機能を実装することで、より完成度の高いシステムになります。

## 1. デバイス管理機能 📱

### 概要
各事業所が契約しているデバイスの管理と職員の割り当て

### 実装内容
- **デバイス一覧ページ** (`app/devices/page.tsx`)
  - 契約デバイスの一覧表示
  - デバイス名、割り当て職員数、状態の表示
- **デバイス追加/編集ページ** (`app/devices/new/page.tsx`, `app/devices/[id]/edit/page.tsx`)
  - デバイス名の設定（例: 事務所iPad、訪問車1号）
  - 最大3名の職員を割り当て
  - デバイスの有効/無効切り替え
- **型定義** (`types/device.ts`)
  - すでに `types/plan.ts` に `Device` 型を定義済み

### ビジネス価値
- 料金体系（1端末1000円/月）と直接連動
- どの職員がどのデバイスを使用しているか明確化
- デバイス追加時の自動料金計算

---

## 2. ユーザー設定・プロフィール管理 ⚙️

### 概要
ログイン中のユーザーの個人設定とプロフィール管理

### 実装内容
- **プロフィールページ** (`app/profile/page.tsx`)
  - 氏名、メールアドレス、職種などの表示
  - アバター画像のアップロード
  - パスワード変更
- **アカウント設定ページ** (`app/settings/page.tsx`)
  - 言語設定（日本語/英語）
  - タイムゾーン設定
  - 表示テーマ（ライト/ダーク）
  - メール通知設定（すでに `types/notification.ts` に `NotificationSettings` 型を定義済み）
- **二段階認証** (`app/settings/security/page.tsx`)
  - SMS認証
  - 認証アプリ連携
  - バックアップコード

### ビジネス価値
- ユーザーの使いやすさ向上
- セキュリティ強化
- 個人のニーズに合わせたカスタマイズ

---

## 3. 監査ログ・アクティビティログ 📋

### 概要
誰が、いつ、何をしたかを記録する監査証跡

### 実装内容
- **アクティビティログページ** (`app/audit-logs/page.tsx`)
  - 操作履歴の一覧表示
  - フィルター（日付範囲、ユーザー、アクション種別）
  - エクスポート機能（CSV、PDF）
- **型定義** (`types/audit-log.ts`)
  ```typescript
  interface AuditLog {
    id: string
    userId: string
    userName: string
    action: 'create' | 'update' | 'delete' | 'login' | 'logout'
    resourceType: 'staff' | 'client' | 'organization' | 'subscription'
    resourceId: string
    changes?: { before: any; after: any }
    ipAddress: string
    userAgent: string
    timestamp: Timestamp
  }
  ```

### ビジネス価値
- コンプライアンス対応（個人情報の取り扱い記録）
- セキュリティインシデント調査
- トラブルシューティング

---

## 4. エクスポート機能 📊

### 概要
各種データをCSV、Excel、PDFで出力

### 実装内容
- **スタッフ一覧のエクスポート**
  - CSV: 全フィールドを含む詳細データ
  - PDF: 印刷用の見やすいレイアウト
- **利用者一覧のエクスポート**
- **請求書のPDF生成**（`types/subscription.ts` の `Invoice` に `invoiceUrl` フィールドあり）
- **レポート生成**
  - 月次レポート（職員数推移、デバイス利用状況など）

### 実装ライブラリ
- `papaparse`: CSV生成
- `xlsx`: Excel生成
- `jspdf` + `jspdf-autotable`: PDF生成

### ビジネス価値
- データの二次利用
- 紙ベースの管理との併用
- 外部システムへのデータ連携

---

## 5. 検索・フィルター機能の強化 🔍

### 概要
既存の一覧ページに高度な検索とフィルター機能を追加

### 実装内容
- **全文検索**
  - スタッフ名、職員番号、メールアドレスなど複数フィールドを横断検索
- **複合フィルター**
  - 職種、役割、有効/無効、登録日範囲など複数条件の組み合わせ
- **ソート機能**
  - 名前順、登録日順、更新日順など
- **保存済み検索条件**
  - よく使う検索条件を保存して再利用

### 実装方法
- Firestoreの複合クエリ
- Algolia等の検索サービス連携（高速全文検索）

### ビジネス価値
- 大量データの中から素早く目的の情報を見つける
- 業務効率の向上

---

## 6. ダッシュボードの統計・グラフ 📈

### 概要
現在は数値のみのダッシュボードをグラフ化して視覚化

### 実装内容
- **職員数の推移グラフ**（折れ線グラフ）
- **利用者数の推移グラフ**
- **デバイス利用率**（円グラフ）
- **月額料金の推移**（棒グラフ）
- **プロダクト別の利用率**（ドーナツグラフ）

### 実装ライブラリ
- `recharts`: React向けグラフライブラリ
- `chart.js` + `react-chartjs-2`: シンプルで高機能

### ビジネス価値
- 一目で状況を把握
- データドリブンな意思決定
- 経営層への報告資料

---

## 7. ヘルプ・サポートページ 📚

### 概要
ユーザーが自己解決できるヘルプコンテンツ

### 実装内容
- **FAQページ** (`app/help/faq/page.tsx`)
  - カテゴリー別のよくある質問
  - 検索機能
- **ユーザーガイド** (`app/help/guide/page.tsx`)
  - 機能ごとの使い方説明
  - スクリーンショット付き手順
- **お問い合わせフォーム** (`app/help/contact/page.tsx`)
  - カテゴリー選択（技術的問題、料金、その他）
  - 添付ファイル対応
- **チュートリアル**
  - 初回ログイン時のウォークスルー
  - 各機能の使い方を段階的にガイド

### ビジネス価値
- サポートコストの削減
- ユーザー満足度の向上
- 学習曲線の短縮

---

## 8. 通知管理ページ 🔔

### 概要
すでに実装した通知機能を拡張

### 実装内容
- **通知一覧ページ** (`app/notifications/page.tsx`)
  - すべての通知を時系列で表示
  - フィルター（未読のみ、事業所のみ、運営のみ）
  - アーカイブ機能
- **通知設定ページ** (`app/notifications/settings/page.tsx`)
  - カテゴリーごとの受信ON/OFF
  - プッシュ通知、メール通知の設定
  - 通知音の設定
- **通知作成ページ**（管理者のみ） (`app/notifications/new/page.tsx`)
  - 事業所の管理者が職員に通知を送信
  - 対象ユーザーの選択（全員/特定のロール）
  - 優先度設定

### ビジネス価値
- 重要な情報の確実な伝達
- コミュニケーションの効率化

---

## 9. バックアップ・データ復元機能 💾

### 概要
データの定期バックアップと復元

### 実装内容
- **自動バックアップ**
  - 日次でFirestoreデータを自動バックアップ
  - Cloud Storage に保存
- **手動バックアップ** (`app/settings/backup/page.tsx`)
  - 管理者がいつでもバックアップを取得
- **データ復元**
  - バックアップからのデータ復元（慎重な操作が必要）

### 実装方法
- Firebase Cloud Functions（スケジュールトリガー）
- Firestore Export API

### ビジネス価値
- データ損失のリスク軽減
- 災害対策（DR: Disaster Recovery）

---

## 10. ロール・権限管理の詳細化 🔐

### 概要
現在は「管理者」と「一般職員」の2つだが、より細かい権限設定

### 実装内容
- **カスタムロール作成** (`app/settings/roles/page.tsx`)
  - 事業所ごとにカスタムロールを作成
  - 機能ごとに権限を設定（例: スタッフ閲覧可、スタッフ編集不可）
- **権限マトリックス**
  - どのロールがどの機能にアクセスできるか一覧表示
- **型定義** (`types/permission.ts`)
  ```typescript
  interface Permission {
    id: string
    name: string
    resource: 'staff' | 'client' | 'organization' | 'subscription'
    action: 'create' | 'read' | 'update' | 'delete'
  }

  interface Role {
    id: string
    name: string
    permissions: string[] // Permission IDs
    organizationId: string
  }
  ```

### ビジネス価値
- セキュリティ強化
- 業務に応じた柔軟な権限設定
- コンプライアンス対応

---

## 11. モバイルアプリ対応（PWA強化） 📱

### 概要
すでにPWAとして設定されているが、さらに機能強化

### 実装内容
- **オフライン対応**
  - Service Worker でデータをキャッシュ
  - オフライン時も閲覧可能
  - オンライン復帰時に自動同期
- **プッシュ通知**
  - Web Push API を利用
  - 新しい通知をリアルタイムで受信
- **ホーム画面への追加促進**
  - インストールプロンプトの表示
- **カメラ連携**
  - ヒヤリハット報告などで写真撮影

### 実装ライブラリ
- `workbox`: Service Worker管理
- Firebase Cloud Messaging (FCM): プッシュ通知

### ビジネス価値
- モバイルファーストの業務フロー
- 現場での使いやすさ向上

---

## 12. テンプレート機能 📝

### 概要
よく使う入力内容をテンプレートとして保存

### 実装内容
- **スタッフ登録テンプレート**
  - 職種や事業所が同じ職員を一括登録
- **通知テンプレート**
  - 定型的な通知文をテンプレート化
- **レポートテンプレート**
  - 月次報告書などのフォーマット

### ビジネス価値
- 入力作業の効率化
- 入力ミスの削減

---

## 13. API連携機能 🔌

### 概要
外部システムとの連携

### 実装内容
- **REST API の提供**
  - 他システムからスタッフ情報を取得
  - Webhook で変更通知
- **API キー管理** (`app/settings/api-keys/page.tsx`)
  - APIキーの発行、無効化
  - 使用状況の確認
- **連携サービス**
  - Google Calendar: シフトを同期
  - Slack: 通知を送信
  - Stripe: 決済処理

### 実装方法
- Next.js API Routes (`app/api/...`)
- Firebase Cloud Functions

### ビジネス価値
- 既存システムとの統合
- エコシステムの拡大

---

## 14. 多言語対応（国際化） 🌐

### 概要
日本語以外の言語にも対応

### 実装内容
- **言語切り替え**
  - 日本語、英語、中国語など
- **翻訳ファイル管理**
  - JSON形式で翻訳を管理
- **実装ライブラリ**
  - `next-intl`: Next.js向け国際化ライブラリ
  - `react-i18next`: Reactの標準的な国際化ライブラリ

### ビジネス価値
- 外国人職員への対応
- 海外展開の準備

---

## 15. パフォーマンスモニタリング 🚀

### 概要
アプリの速度とエラーを監視

### 実装内容
- **エラートラッキング**
  - Sentry: JavaScriptエラーを自動収集
- **パフォーマンス測定**
  - Google Analytics
  - Firebase Performance Monitoring
- **アラート設定**
  - エラー率が閾値を超えたら通知

### ビジネス価値
- ユーザー体験の向上
- 問題の早期発見と修正

---

## 優先度の提案

### 高優先度（すぐに実装すべき）
1. **デバイス管理機能** - 料金体系と直結
2. **通知管理ページ** - すでに基礎実装済み
3. **ユーザー設定・プロフィール管理** - 基本機能として必須
4. **エクスポート機能** - データの二次利用に必要

### 中優先度（段階的に実装）
5. **監査ログ** - セキュリティとコンプライアンス
6. **検索・フィルター強化** - ユーザビリティ向上
7. **ダッシュボードグラフ化** - データ可視化
8. **ヘルプ・サポートページ** - サポートコスト削減

### 低優先度（将来的に検討）
9. **ロール・権限管理の詳細化** - 規模拡大時
10. **バックアップ機能** - Firebaseの自動バックアップがあるため
11. **テンプレート機能** - 運用が安定してから
12. **API連携** - 外部システム連携の要望があれば
13. **多言語対応** - 海外展開時
14. **パフォーマンスモニタリング** - 運用開始後

---

## まとめ

プロダクト機能（ヒヤリハット、シフト管理など）以外にも、基盤機能として実装すべき項目が多数あります。特に**デバイス管理**、**通知管理**、**ユーザー設定**、**エクスポート**あたりは、システムの完成度を高めるために早めに実装することをおすすめします。
